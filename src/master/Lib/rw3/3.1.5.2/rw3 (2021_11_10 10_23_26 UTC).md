# 核心库说明：

### 近期升级计划：

### 更新日志：

### 2021-11-10
#### 3.1.5.1
1. 修复：JsonConfig调用Save时报错的问题。
2. 优化：ucBaseManagerUI新增了ShowChild方法，可用于打开二级子界面。
3. 优化：ucBaseIDNameManager新增了DataChanged事件，可用于事件回调。

### 2021-10-27
#### 3.1.5
* 兼容：做了大量向前兼容功能。
已设置兼容项点：
	1. RW.UI/RW.UI.BLL/RW.UI.Manager/RW.UI.Manager.User/RW.SelfTest/RW.UI.Controls
已兼容的项目：
	1. HNRWS17043 交流异步牵引电动机例行试验台
	2. HNRWS19027_阀类全自动综合试验台
	3. HNRWS19090 驱动装置试验设备
	4. HNRWS17080 牵引电机空载试验台
	5. HNRWS17067-7 电机空载试验台
	6. GJCS20020-30阀试验台
	7. HNRWS19098 登顶门禁系统
	8. HNRWS19076 驱动装置试验设备
	9. HNRWS19025 便携式受电弓测试仪
	10. HNRWS17122压力调整阀
	11. HNRWS19058 受电弓试验台
	12. 电磁阀类性能试验台
	13. GJCS20022-2 制动阀综合测试
	14. GJCS20058 继电器万能试验台
	15. PXCS20001-2-真空断路器试验台
	16. GJXX20005 无人驾驶仿真试验平台
未兼容的项点：
	1. ucBaseIDNameManager的属性，BaseIdName改为IIDNameBLL
	2. BaseProcedure的方法，Collect() 的返回类型从BaseResult改为IResult  Collect(params BaseModule[] modules)方法改为Collect(params IModule[] modules)
	3. BaseProcedure的方法，OnTicked方法的返回值改为double类型
	4. frmReport类，Opened事件的类型从OpenHandler改为EventHandler，其参数OpenedReportArgs改为EventArgs
	5. ini.Config.GetSections(filename)  改为 ini.Config.GetSections()
	6. ini.Config.GetKeys(filename,projects[i]) 改为 ini.Config.GetKeys(projects[i])

### 2021-10-26
#### 3.1.4
* 移除：移除了NPOI库及相关支持类，独立了rw.Report.NPOI.Excel库。

### 2021-09-18
#### 3.1.3.51
* 优化：优化了frmSettingMain界面，将AddNodes方法获取，新增了Nodes属性。

### 2021-09-14
#### 3.1.3.50
* 修复：优化登录界面Logo没有自适应的问题。

###2021-08-30
#### 3.1.3.47 - 49
* 优化：优化uchardGroup控件支持Text属性，可自定义名称。
* 预新增：预计增加Ini配置文件的单位属性。
* 修复：修复moduleExtender组件中，当使用零点增益会出现先变成原始值再进行零点增益计算值的问题。
* 优化：增加了一些注释。
### 2021-08-20
#### 3.1.3.46
* 优化：优化RButton支持获取焦点，解决了输入文本后，不会使其失去焦点的问题。
### 2021-08-12
#### 3.1.3.45
* 调整：将config\calibration.ini文件自动移动到\configs\calibration.ini文件中。
#### 3.1.3.44
* 修复：修复SetLocal在读取Ini文件未找到时，会默认修改为false的问题。（导致了所有硬件点位setlocal=false，默认应该为true）
* 优化：优化了Hardware的SetLocal属性和Index属性，当其为默认值时，不写入到ini文件中。

### 2021-08-05
####3.1.3.42
* 修复：修复零点增益写下位机时，仍然进行了计算的问题。（SetLocal未写入到配置信息中）
#### 3.1.3.41
* 优化：优化LabelSwitch刷新速度快时，导致闪屏的问题。
* 修复：Invoke报错时，提示调用错误，而不是具体错误内容。
###2021-08-03
#### 3.1.3.40
* 修复：修复NPOI读写Excel时，使用“AA1”，无法正确识别正确的列的问题。（BA1问题未解决）
### 2021-08-02
#### 3.1.3.39
* 修复：修复字符串1，转换成bool类型为false的问题，应该为1.
#### 3.1.3.38
* 优化：优化BaseRWButton类的Switching事件支持抛出异常，可正确提示错误信息。
* 优化：优化了部分页面使用RWConvert的扩展方法转换，而不是直接的Convert转换。
### 2021-07-31
#### 3.1.3.37
* 优化：优化了RWConvert方法，调整到RW命名空间，使所有RW.xxx默认都能使用到，而无需额外引用命名空间。
* 优化：优化了RWConvert中部分方法，增加了常用类型转换，移除了不常用的方法，更改了不分名称。
### 2021-07-30
#### 3.1.3.36
* 优化：moduleExtender组件，初始化时可支持忽略错误。
* 新增：LogHelper新增了Error方法，可快速记录错误日志。
#### 3.1.3.35
* 优化：优化零点增益控件，如果配置了零点和增益的OPC点位，自动写入到下位机中。
#### 3.1.3.34
* 优化：优化OPCDriver在Write时，会提示OPC错误事件的问题。（移除，只保留了添加点位、Shutdown的错误事件）

### 2021-07-29
#### 3.1.3.32
* 优化：优化OPCDriver的KeyValue事件，数据类型为double时，可能出现超长小数点问题。采用Convert.ToDouble,decimal,double的转换过程调整。
### 2021-07-21
#### 3.1.3.31
* 优化：优化在设计时，Text属性支持了多行模式的设计。（AIRLabel、LabelSwitch、AINum..、SwitchLabelD等等）
#### 3.1.3.29
* 优化：AILabel控件Label属性的默认值。
* 优化: LabelSwitch渐变色的原色。

### 2021-07-17
#### 3.1.3.28
* 优化：优化AILabel单位显示位置太靠右的问题。

### 2021-07-16
#### 3.1.3.27
* 优化：使用渐变色优化了LabelSwitch控件。
#### 3.1.3.23
* 新增：新增了一种Switch控件，LabelSwitch，可用于替换SwitchLabel控件。

#### 3.1.2.22
* 修复：修复使用ModuleExtender关联点位时，设置了超时时间，由于国际化翻译导致报错的问题。
* 优化：优化moduleExtender初始化时，未设置doKey将进行提示。（必须设置了moduleName属性才检测）

### 2021-07-09
#### 3.1.2.20-21
* 调整：调整了IValueView接口，将Label属性，调整为Text属性。
* 优化：优化了AILabel、AINumericDisplay、ucAINumericDisplay控件，将Label属性标记为过期，使用Text属性.
		(为了兼容老旧项目，该属性仍然可用，程序仍然以此为第一使用条件，建议清空掉此值并设置到Text属性中)
#### 3.1.2.19
* 修复：ucNumericalDisplay、AINumericalDisplay的Label属性不支持国际化的问题。

### 2021-07-08
#### 3.1.2.18
* 优化：优化AILabel支持BorderWidth和BorderColor属性。

### 2021-07-06
#### 3.1.2.17
* 优化：优化RWBox在多页面时，可能使用第一个页面的问题。（现在是最后一个页面）
* 修复：硬件校准控件，如果只给定了一个点无法读取模块值的问题。

### 2021-07-05
#### 3.1.2.15 - 16
* 优化：优化硬件校准模块【RWhards】可能无法设置InputTagName的问题。
* 优化：SystemConfig如果外部设置了文件名，不再使用默认文件名。
#### 3.1.2.14
* 优化：优化SystemConfig的默认配置文件名为sys.ini功能。
#### 3.1.2.13
* 优化：移除了登录界面的默认ICO，可由用户指定。
* 优化：验证密码从基类Form继承。
### 2021-07-03
### 3.1.2.12
* 优化：系统参数支持多语言配置（完全不同的文件）。
#### 3.1.2.11
* 优化：支持多语言配置的IniKeyName。
#### 3.1.2.10
* 优化：多语言登录时，会保存最后的登录语言。再次登录时，将使用默认语言。
* 优化：优化了UserConfig调整到RWUser类中。（外观模式）

### 2021-07-01
#### 3.1.2.5
* 新增：新增IniKeyName支持了国际化属性SRIniKeyName支持使用资源获取描述。
#### 3.1.2.4
* 修复：修复多语言登录，不能获取语言选中值。且无法设置默认值。

### 2021-06-30
#### 3.1.2.3
* 优化： 优化了RWBox组件，参数调整为object类型。
#### 3.1.2.2
* 优化： 优化了RWBox组件，支持YesNO、Retry等方法，并增加了注释。
#### 3.1.2.1
* 修复：修复登录界面，切换英文后再切回中文部分没有显示中文内容的问题。
#### 3.1.2
* 优化：完善了国际化支持。（中英文翻译）
* 新增：新增了RWBox组件，可方便的进行的弹窗，而无需使用MessageBox，后续可升级成自定义弹窗。

### 2021-06-28
#### 3.1.1.1
* 新增：新增了多语言的登录框。
#### 3.1.0
* 调整：底层库，支持国际化的功能。
* 预计：预计将dapper移除调整为sqlsugar作为底层库的数据库工具库。

### 2021-06-23
#### 3.0.11.1
* 优化：优化UsingConnect的时候，多次连接的问题。现在先判断是否已连接。
### 2021-06-21
#### 3.0.11 by yuanyong
* 调整：BaseIDNameBLL提取了接口IIDNameBLL，所有继承了ucBaseIDName的控件需调整。

### 2021-06-09
#### 3.0.10.25 by yuanyong
* 优化：优化NPOI写入值全部增加sheetIndex的功能。

### 2021-05-13
#### 3.0.10.24 by yuanyong
* 修复：修复SystemConfig的路径调整后，configs文件夹如果不存在会报错的问题。（另外，自动删除了config的空文件夹）
### 2021-05-05
#### 3.0.10.22 by yuanyong
* 优化：快捷键新增了更多的快捷操作。
#### 3.0.10.21 by yuanyong
* 优化：SystemConfig的路径调整为configs\sys.ini。程序自动拷贝文件。
#### 3.0.10.19 by yuanyong
* 优化：frmConfigManager的自动参数界面支持了对象和数组。

### 2021-04-23
#### 3.0.10.18
* 优化：优化页面快捷键注册时，自动设置允许接收快捷键功能。
#### 3.0.10.15
* 新增：新增了页面快捷键功能。

### 2021-04-22
#### 3.0.10.13-14
* 修复：解决了当OPCDriver关闭后，重新连接无法写入值的问题。
* 修复：修复重连后需要写入一次才会刷新值的问题（临时变量未清空）。
#### 3.0.10.10
* 修复：修复OPCDriver.Close时，IsConnected属性仍然为true的问题。
#### 3.0.10.9
* 优化：调整了IDriverConfig接口，支持DriverKey，当使用DriverFactory创建驱动时，可以创建不同实例。

### 2021-04-19
#### 3.0.10.8
* 优化：优化NPOI类，支持隐藏行列，支持按单元格名称写入值，支持按单元格插入图片，支持写多个sheet表单。

### 2021-04-13
#### 3.0.10.7
* 新增：MathExtender类，支持浮点数的减法和除法功能。（a.Sub(b),b.Divide(a)）

### 2021-04-07
#### 3.0.10.1
* 修复：修复反射IniConfig类型时，自带了Keys和Values的问题。
#### 3.0.10.2
* 修复：修复AINumber..和BaseAIControl类中，获取单位时，未获取到自定义单位的问题。
#### 3.0.10.3 - 4
* 优化：ucKeyValue控件优化、完善，支持标签宽度设置。完善了示例测试。
* 优化：frmConfigrationManager支持单元项大小设置。
#### 3.0.10.5-6
* 优化：优化了当hardware控件未创建时，无法设置ZeroValue的问题。（ControlHelper.Invoke IsHandlerCreate判断）

### 2021-03-10
#### 3.0.10
* 新增：frmConfigDialog正式支持了Json配置文件。

### 2021-03-08
#### 3.0.9.0
* 优化：AOControl自适应大小的功能。
* 新增：增加了SwitchControl控件。
* 优化：frmSetValue界面调整，输入框更大，运行时自动获得输入焦点。
#### 3.0.9.1
* 优化：AOControl的Button调整为RButton控件。

### 2021-03-04
#### 3.0.8.16
* 修复：修复用户管理可以添加相同的用户的问题。
* 优化：frmConfigDialog界面增加了“退出”按钮和移除了“重置”按钮。

### 2021-02-05
#### 3.0.8.13
* 稳定性修复：修复所有点动按钮在快速点击时，会出现无法复位状态的问题。
* 调整：frmHardwareSlice的Unit属性改为string类型，手动输入单位的功能。
* 优化：又又完善了一些注释。
#### 3.0.8.14
* 优化：优化UCCalibration控件，点击确定时，有闪烁的问题。

### 2021-02-04 3.0.8.11
* ★重大优化：优化使用BaseModule时，会注册两次ValueChanged事件，导致客户端触发2次事件的问题。
* 完善：完善了OPCDriver、BaseModule的注释说明。

### 2021-02-03 3.0.8.10
* 优化：调整了LogHelper.Append方法，改为WriteLine方法。
* 修复：修复OPCDriver连接报错时，可能提示未将对象的引用设置的实例错误问题。
* 完善：一些注释代码。
* 新增：增加了IOutputTag接口，用于描述输出DO点的输出功能（接口优化）。
		新增了IOutputValue接口，用于描述AO点的输出功能。（接口新增）

### 2021-01-27 3.0.8.8
* 修复：修复Rbutton类左键在任意地方电机都会触发事件的问题。
* 优化：移除了ControlHelper的按钮锁。

### 2021-01-23 3.0.8.7
* 优化：优化自定义配置项。

### 2021-01-20 3.0.8.6
* 修复：修复使用ModuleExtender结合自动生成的控件，RButton会出现线程间操作异常的问题。

### 2021-01-19 3.0.8.5
* 优化：取消了注册点位后立即读取的功能。（由于点位不存在时会出现无法读取指定内存的异常。）
* 新增（未完成）：通用硬件确认界面功能。

### 2021-01-15 3.0.8.3
* 调整了IConfigCollection接口，支持获取所有值。
* 完善：配置工具达到测试版要求。

### 2021-01-07 3.0.8.2
* 重大修复：修复3.0.8+版本中，ShowDialog之后调用Dispose会导致程序卡死的问题。
* 优化：UserBLL静态构造会报错的问题。

### 2021-01-06 3.0.8.1
* 优化：优化了参数配置界面自动生成和手动生成的逻辑。
* 优化：优化了分段零点增益界面。

### 2021-01-05 3.0.8
* 新增：增加了配置文件工具支持界面。

### 2021-01-04 3.0.7.1
* 新增：零点增益控件增加了归零功能，自动根据当前值设置零点。（测试中）
* 新增：增加了重置按钮、归零按钮可选显示的方式。
* 新增：增加了零点、增益的小数点数量。

#### 2020-12-29 3.0.6.6
* 优化：RWHardGroup组件增加零点、增益小数点数量。默认为3.

#### 2020-12-29 3.0.6.5
* 修复：UCCalibration可能导致异步操作控件的问题。
* 优化：HardwareConfig类增加了可继承重写读写点位的功能。
* 优化：ControlHelper当碰到页面释放报错的问题。

#### 2020-12-28 3.0.6.4
* 新增（未完成）：断言功能，可用于领域特性语言判断某个值。
* 新增（未完成）：添加日志由Append改为WriteLine，可快速替换Debug.Write();
* 优化：优化异步调用ControlHelper时，可能出现locker的问题。

#### 2020-12-19 3.0.6.3
* 优化：当使用moduleExtender时，未注册的点位提示“未将对象的引用设置到对象的实例”的问题。

#### 2020-12-18 3.0.6.1 - 2
* 优化：增加了OPC连接日志等信息。
* 优化：当BaseModule触发ValueChanged事件时，可能触发到已释放的页面，导致报错的问题。

#### 2020-12-12 3.0.4
* 新增：增加配置工具的功能。

#### 2020-11-28 3.0.3
* 修复BaseRWButton的AsyncClick属性不生效的问题。
* 修复：修复BaseRWButton没有点击反馈的问题。

#### 2020-11-27 3.0.0
* 功能增加，移除了过时代码。
* 代码优化和删减，移除了所有的国际化语言。（后续考虑使用扩展语言包）
* 审查了所有的obslute代码，并进行了大部分移除。